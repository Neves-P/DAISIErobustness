test_that("calc_ed95_param_set works", {
  skip_if(Sys.getenv("CI") == "", message = "Run only on CI")
  ed95 <- suppressMessages(
    calc_ed95_param_set(file.path(getwd(), "testdata/results/"))
  )

  expected_output <- data.frame(
    param_space_name = c(
      rep("oceanic_ontogeny_sea_level_cs", 6),
      rep("oceanic_sea_level_cs", 2)
    ),
    param_set = c(228, 230, 240, 251, 255, 483, 443, 445),
    ed95_spec_nltt = c(
      0.0196078431372549,
      0.1764705882352941,
      0.0588235294117647,
      0.0392156862745098,
      0.0980392156862745,
      0.0784313725490196,
      0.0784313725490196,
      0.1960784313725490
    ),
    ed95_endemic_nltt = c(
      0.0196078431372549,
      0.0196078431372549,
      0.0392156862745098,
      0.1568627450980392,
      0.0588235294117647,
      0.1568627450980392,
      0.1176470588235294,
      0.0784313725490196
    ),
    ed95_nonendemic_nltt = c(
      0.0980392156862745,
      0.1372549019607843,
      0.0392156862745098,
      0.0784313725490196,
      0.0784313725490196,
      0.0196078431372549,
      0.1176470588235294,
      0.1960784313725490
    ),
    ed95_num_spec = c(
      0.1176470588235294,
      0.1764705882352941,
      0.0588235294117647,
      0.1568627450980392,
      0.0784313725490196,
      0.1176470588235294,
      0.0588235294117647,
      0.2352941176470588
    ),
    ed95_num_col = c(
      0.1176470588235294,
      0.1372549019607843,
      0.1176470588235294,
      0.1568627450980392,
      0.0588235294117647,
      0.1372549019607843,
      0.0588235294117647,
      0.1764705882352941
    )
  )

  expect_equal(ed95, expected_output)
})
