test_that("calc_ed95_param_set works", {
  skip_if(Sys.getenv("CI") == "", message = "Run only on CI")

  ed95 <- suppressMessages(
    calc_ed95_param_set(file.path(getwd(), "testdata/results/"))
  )

  expected_output <- data.frame(
    param_space_name = c(rep("nonoceanic_land_bridge", 2), rep("oceanic_sea_level", 4)),
    param_set = c(123, 92, 237, 279, 473, 569),
    ed95_spec_nltt = c(
      0.99900099900099903,
      0.99600399600399603 ,
      0.05394605394605394,
      0.04995004995004995,
      0.03496503496503497,
      0.04095904095904096
    ),
    ed95_endemic_nltt = c(
      0.97402597402597402,
      0.97702297702297702,
      0.04695304695304695,
      0.04195804195804196,
      0.04695304695304695,
      0.04095904095904096
    ),
    ed95_nonendemic_nltt = c(
      0.99800199800199796,
      0.99700299700299699,
      0.04595404595404595,
      0.04695304695304695,
      0.03996003996003996,
      0.05394605394605394
    ),
    ed95_num_spec = c(
      0.04995004995004995,
      0.05394605394605394,
      0.06293706293706294,
      0.04095904095904096,
      0.03896103896103896,
      0.05194805194805195
    ),
    ed95_num_col = c(
      0.04495504495504495,
      0.02797202797202797,
      0.06893106893106893,
      0.03396603396603397,
      0.03796203796203796,
      0.04795204795204795
    )
  )

  expect_equal(ed95, expected_output)
})
