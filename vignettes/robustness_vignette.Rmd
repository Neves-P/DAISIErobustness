---
title: "robustness_vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{robustness_vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Introduction

## What is DAISIErobustness?
DAISIErobustness is an R package for testing of the robustness of the island biogeography model "[DAISIE](https://github.com/rsetienne/DAISIE)" (_Dynamical Assembly of Islands by Speciation, Immigration and Extinction_)  to more complex and potentially more realistic evolutionary models. Different measures of error of number of species, endemics, non-endemics and evolutionary trajectories are used to determine whether the alternative models can influence the inference capabilities of the current DAISIE model.

## DAISIErobustness pipeline
DAISIErobustness consists of a pipeline designed to measure the error one creates when extending the standard DAISIE model with new features. Examples of such new additions include the modelling of island ontogeny, as per the General Dynamic Model<sup>1</sup>, sea level changes<sup>2</sup>, and non-oceanic scenarios. The error measure is obtained by simulating and comparing DAISIE data using simulation code that builds upon the existing DAISIE simulations by including geodynamic processes.

# Usage
## Running the full pipeline
The full pipeline can be called by the external function `run_robustness()` and setting the `pipeline` argument to `"full"`.
```{r eval = FALSE, run_robustness}
library(DAISIErobustness)
run_robustness(
  param_space_name = "nonoceanic",
  param_set = 1,
  replicates = 2,
  pipeline = "full",
  novel_sim = NULL,
  save_output = FALSE
)
```


The DAISIErobustness pipeline is divided in two sections. The first one, handled by the internal function `run_novel_sim()` generates DAISIE simulations that deviate from the standard assumptions of the model by including geodynamic or trait dependent processes. A user friendly way of running the first section of the pipeline is through the use of `run_robustness()` with the `pipeline` parameter set to `"novel_sim"`.

```{r eval = FALSE, run_novel_sim}
run_robustness(
  param_space_name = "nonoceanic",
  param_set = 1,
  replicates = 2,
  pipeline = "novel_sim",
  novel_sim = NULL,
  save_output = FALSE
)
```

The second one, handled by the `run_analysis()` function reads from previously generated simulations (including ones generated by `run_novel_sim()`), calculates the DAISIE ML parameter estimates and uses these to generate standard oceanic DAISIE simulations. These are then subject to MLE and once more the resulting estimates are used to generate a second set of oceanic DAISIE simulations. Different error metrics are then computed to obtain measures of the baseline error, i.e., the inherent error in any estimation/simulation procedure, and subsequently the error obtained by simulating the novel processes.
To run just the second half of the pipeline one can again resort to the `run_robustness()` function, with the `pipeline` argument set to `"run_analysis"` and with a valid path to a novel simulation output.

```{r eval = FALSE, run_analysis}
run_robustness(
  param_space_name = "nonoceanic",
  param_set = 1,
  replicates = 2,
  pipeline = "analysis",
  novel_sim = "novel_sim_output/nonoceanic_1.RData",
  save_output = FALSE
)
```

# References
<sup>1</sup>Whittaker, Robert J., Kostas A. Triantis, and Richard J. Ladle. "A general dynamic theory of oceanic island biogeography." _Journal of Biogeography_ 35.6 (2008): 977-994.

<sup>2</sup>Fernández‐Palacios, José María, et al. "Towards a glacial‐sensitive model of island biogeography." _Global Ecology and Biogeography_ 25.7 (2016): 817-830.
